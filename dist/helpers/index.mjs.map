{"version":3,"sources":["c:\\work\\akeyless\\commons\\client_commons\\dist\\helpers\\index.mjs"],"names":["moment","initializeApp","getStorage","getAuth","addDoc","collection","deleteDoc","doc","getDoc","getDocs","query","setDoc","Timestamp","where","getFirestore","onSnapshot","formatCarNumber","car_number","cn2","length","initApp","isNodeEnv","process","env","firebaseConfig","apiKey","NEXT_PUBLIC_API_KEY","VITE_API_KEY","authDomain","NEXT_PUBLIC_AUTH_DOMAIN","VITE_AUTH_DOMAIN","projectId","NEXT_PUBLIC_PROJECT_ID","VITE_PROJECT_ID","storageBucket","NEXT_PUBLIC_STORAGE_BUCKET","VITE_STORAGE_BUCKET","messagingSenderId","NEXT_PUBLIC_MESSAGING_SENDER_ID","VITE_MESSAGING_SENDER_ID","appId","NEXT_PUBLIC_APP_ID","VITE_APP_ID","app","auth2","db2","storage2","db","auth","storage","error","console","collections","clients","sites","cars","users","lastLocations","ermEvents","erm2Events","ruptelaEvents","polygons","polygonEvents","polygonCars","canbus","states","app_pro_commands_queue","trips","tripsDetails","audit","nx_settings","settings","translations","nx_cars","boards","protection_types","board_types","charge_capacities","fire_base_TIME_TEMP","now","extractAlertsData","doc2","data","timestamp","timestamp_seconds","seconds","timestamp_ui","unix","format","simpleExtractData","docData","id","extractSiteData","dateUpdated","Date","updated","nanoseconds","dateCreated","created","extractClientData","extractBoardsData","dateUploaded","uploaded","extractCarsData","carData","icon","gov_info","vehicle_type","brand","manufacturer","carId","extractCanbusData","newDate","date_ui","extractLocationData","locationData","latitude","longitude","spd","prev_latitude","prev_longitude","lat","lng","prev_lat","prev_lng","Number","toFixed","get_all_documents","collection_path","snapshot2","documents","docs","map","get_document_by_id","doc_id","doc_ref","doc_snap","exists","Error","set_document","merge","add_document","include_id","col_ref","delete_document","query_document","field_name","operator","value","ignore_log","q","query_snapshot","query_documents","query_documents_by_conditions","where_conditions","db_query","forEach","condition","JSON","stringify","query_document_by_conditions","snapshot","config","snapshotsFirstTime","resolvePromise","isResolved","promise","Promise","resolve","log","collectionName","collectionRef","conditions","unsubscribe","includes","push","onFirstTime","extraParsers","extraParser","addedDocs","modifiedDocs","removedDocs","docChanges","change","type","onAdd","onModify","onRemove","snapshotDocument","documentRef","documentId","docSnapshot","document2","checkConditions","warn","every","fieldValue","Array","isArray","cleanNxSites","allSitesToDelete","v","filter","client","CountryOptions","axios","parsePhoneNumberFromString","isInternational","phone_number","startsWith","isInternationalIsraelPhone","local_israel_phone_format","international_number","replace","international_israel_phone_format","phone","validNumber","slice","concat","displayFormatPhoneNumber","phoneNumber","phoneNumberObject","formatInternational","is_iccid","number","test","calculateBearing","startLat","startLng","endLat","endLng","startLatRad","Math","PI","startLngRad","endLatRad","endLngRad","dLon","y","sin","cos","x","bearing","atan2","renderOnce","getUserCountryByIp","response","get","country_code","IL","toLowerCase","parsePermissions","object","features","result","feature","split","featureType","featureName","initializeUserPermissions","firstTimeArray","getUpdatePermissions","permissions","unsubscribeSnapshot","message","userNameFormat","user","first_name","last_name","trim","multiStringFormat","str1","str2","str3","getLocationUrl","lang","XRegExp","textRegex","numbersRegex","numbersOnlyRegex","priceRegex","emailRegex","colorRegex","carsRegex","textNumbersRegex","addressRegex","chartsRegex","handleChange","e","target","setCustomValidity","validation","getAttribute","handlePaste","currentTarget","pasteData","clipboardData","getData","preventDefault","document","execCommand","handleInvalid","requireError","useValidation","validationType","onChange","onPaste","onInvalid","getFormElementValue","form","name","elements","namedItem","parseMultiSelectInput","input","parse","setState","updater","set","stateName","state","createSelectors","store","selectors","k","s","Object","keys","getState","useStoreValues","key","use","clsx","twMerge","cn","inputs","Timestamp2","moment2","timestamp_to_string","firebaseTimestamp","options","date","toDate","utc","fromFormat","isNaN","getTime","tz","timestamp_to_millis","toMillis","sort_by_timestamp","a","b","reverse"],"mappings":"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","sourcesContent":["// src/helpers/firebase.ts\nimport moment from \"moment\";\nimport { initializeApp } from \"firebase/app\";\nimport { getStorage } from \"firebase/storage\";\nimport { getAuth } from \"firebase/auth\";\nimport {\n  addDoc,\n  collection,\n  deleteDoc,\n  doc,\n  getDoc,\n  getDocs,\n  query,\n  setDoc,\n  Timestamp,\n  where,\n  getFirestore,\n  onSnapshot\n} from \"firebase/firestore\";\n\n// src/helpers/cars.ts\nvar formatCarNumber = (car_number) => {\n  var cn2 = car_number;\n  if (cn2?.length == 8) return `${cn2[0]}${cn2[1]}${cn2[2]}-${cn2[3]}${cn2[4]}-${cn2[5]}${cn2[6]}${cn2[7]}`;\n  if (cn2?.length == 7) return `${cn2[0]}${cn2[1]}-${cn2[2]}${cn2[3]}${cn2[4]}-${cn2[5]}${cn2[6]}`;\n  if (cn2?.length == 6) return `${cn2[0]}${cn2[1]}-${cn2[2]}${cn2[3]}-${cn2[4]}${cn2[5]}`;\n  if (cn2?.length == 5) return `${cn2[0]}-${cn2[1]}${cn2[2]}-${cn2[3]}${cn2[4]}`;\n  return cn2;\n};\n\n// src/helpers/firebase.ts\nvar initApp = () => {\n  const isNodeEnv = typeof process !== \"undefined\" && process.env;\n  const firebaseConfig = {\n    apiKey: isNodeEnv ? process.env.NEXT_PUBLIC_API_KEY : import.meta.env.VITE_API_KEY,\n    authDomain: isNodeEnv ? process.env.NEXT_PUBLIC_AUTH_DOMAIN : import.meta.env.VITE_AUTH_DOMAIN,\n    projectId: isNodeEnv ? process.env.NEXT_PUBLIC_PROJECT_ID : import.meta.env.VITE_PROJECT_ID,\n    storageBucket: isNodeEnv ? process.env.NEXT_PUBLIC_STORAGE_BUCKET : import.meta.env.VITE_STORAGE_BUCKET,\n    messagingSenderId: isNodeEnv ? process.env.NEXT_PUBLIC_MESSAGING_SENDER_ID : import.meta.env.VITE_MESSAGING_SENDER_ID,\n    appId: isNodeEnv ? process.env.NEXT_PUBLIC_APP_ID : import.meta.env.VITE_APP_ID\n  };\n  try {\n    const app = initializeApp(firebaseConfig);\n    const auth2 = getAuth(app);\n    const db2 = getFirestore(app);\n    const storage2 = getStorage(app);\n    return { db: db2, auth: auth2, storage: storage2 };\n  } catch (error) {\n    console.error(\"Failed to initialize Firebase app:\", error);\n    return { db: null, auth: null };\n  }\n};\nvar { db, auth, storage } = initApp();\nvar collections = {\n  clients: collection(db, \"nx-clients\"),\n  sites: collection(db, \"nx-sites\"),\n  cars: collection(db, \"units\"),\n  users: collection(db, \"nx-users\"),\n  lastLocations: collection(db, \"last_locations\"),\n  ermEvents: collection(db, \"erm_events_general\"),\n  erm2Events: collection(db, \"erm2_events_general\"),\n  ruptelaEvents: collection(db, \"ruptela_events_general\"),\n  polygons: collection(db, \"nx-polygons\"),\n  polygonEvents: collection(db, \"polygon_events\"),\n  polygonCars: collection(db, \"polygon_cars\"),\n  canbus: collection(db, \"erm_canbus_parameters\"),\n  states: collection(db, \"erm_states\"),\n  app_pro_commands_queue: collection(db, \"app_pro_commands_queue\"),\n  trips: collection(db, \"erm2_trip\"),\n  tripsDetails: collection(db, \"erm2_trip_details\"),\n  audit: collection(db, \"nx-audit\"),\n  nx_settings: collection(db, \"nx-settings\"),\n  settings: collection(db, \"settings\"),\n  translations: collection(db, \"nx-translations\"),\n  nx_cars: collection(db, \"nx-cars\"),\n  boards: collection(db, \"boards\"),\n  protection_types: collection(db, \"protectionTypes\"),\n  board_types: collection(db, \"boardTypes\"),\n  charge_capacities: collection(db, \"nx-charge-capacities\")\n};\nvar fire_base_TIME_TEMP = Timestamp.now;\nvar extractAlertsData = (doc2) => {\n  const data = doc2.data();\n  const { car_number, timestamp } = data;\n  return {\n    ...data,\n    timestamp_seconds: timestamp.seconds,\n    timestamp_ui: moment.unix(timestamp.seconds).format(\"DD/MM/YY HH:mm\"),\n    car_number: formatCarNumber(car_number)\n  };\n};\nvar simpleExtractData = (doc2) => {\n  const docData = doc2.data();\n  return {\n    ...docData,\n    id: doc2.id\n  };\n};\nvar extractSiteData = (doc2) => {\n  const data = doc2.data();\n  const dateUpdated = new Date(data.updated?.seconds * 1e3 + data.updated.nanoseconds / 1e6);\n  const dateCreated = new Date(data.created?.seconds * 1e3 + data.created.nanoseconds / 1e6);\n  return {\n    ...data,\n    id: doc2.id,\n    created: moment(dateCreated).format(\"DD.MM.YYYY - HH:mm\"),\n    updated: moment(dateUpdated).format(\"DD.MM.YYYY - HH:mm\")\n  };\n};\nvar extractClientData = (doc2) => {\n  const data = doc2.data();\n  const dateUpdated = new Date(data.updated?.seconds * 1e3 + data.updated.nanoseconds / 1e6);\n  const dateCreated = new Date(data.created?.seconds * 1e3 + data.created.nanoseconds / 1e6);\n  return {\n    ...data,\n    id: doc2.id,\n    created: moment(dateCreated).format(\"HH:mm  DD/MM/YY\"),\n    updated: moment(dateUpdated).format(\"HH:mm  DD/MM/YY\")\n  };\n};\nvar extractBoardsData = (doc2) => {\n  const data = doc2.data();\n  const dateUploaded = typeof data.uploaded === \"string\" ? data.uploaded : moment.unix(data.uploaded?.seconds).format(\"DD/MM/YY HH:mm\");\n  return {\n    ...data,\n    id: doc2.id,\n    uploaded: dateUploaded\n  };\n};\nvar extractCarsData = (doc2) => {\n  const carData = doc2.data();\n  let icon;\n  const gov_info = carData.gov_info;\n  if (gov_info) {\n    if (carData.icon) {\n      icon = carData.icon;\n    } else if (gov_info.vehicle_type === \"atv\") {\n      icon = \"truck\";\n    } else if (gov_info.vehicle_type === \"motorcycle\") {\n      icon = \"motorcycle\";\n    } else {\n      icon = \"car\";\n    }\n  } else {\n    icon = \"car\";\n  }\n  return {\n    ...carData,\n    id: doc2.id,\n    brand: carData.brand || carData.manufacturer,\n    car_number: carData.carId,\n    icon\n  };\n};\nvar extractCanbusData = (doc2) => {\n  const data = doc2.data();\n  const newDate = new Date(data.timestamp.seconds * 1e3);\n  return {\n    ...data,\n    date_ui: moment(newDate).format(\"DD/MM/YYYY - HH:mm\")\n  };\n};\nvar extractLocationData = (doc2) => {\n  const locationData = doc2.data();\n  const { latitude, longitude, spd, timestamp, prev_latitude, prev_longitude } = locationData;\n  return {\n    ...locationData,\n    id: doc2.id,\n    lat: latitude,\n    lng: longitude,\n    prev_lat: prev_latitude,\n    prev_lng: prev_longitude,\n    timestamp: timestamp?.seconds,\n    spd: Number(spd).toFixed(0)\n  };\n};\nvar get_all_documents = async (collection_path) => {\n  try {\n    const snapshot2 = await getDocs(collection(db, collection_path));\n    const documents = snapshot2.docs.map((doc2) => simpleExtractData(doc2));\n    return documents;\n  } catch (error) {\n    return [];\n  }\n};\nvar get_document_by_id = async (collection_path, doc_id) => {\n  try {\n    const doc_ref = doc(db, collection_path, doc_id);\n    const doc_snap = await getDoc(doc_ref);\n    if (!doc_snap.exists()) {\n      throw new Error(\"Document not found, document id: \" + doc_id);\n    }\n    return simpleExtractData(doc_snap);\n  } catch (error) {\n    console.error(\"Error from get_document_by_id\", error);\n    return null;\n  }\n};\nvar set_document = async (collection_path, doc_id, data) => {\n  try {\n    const doc_ref = doc(db, collection_path, doc_id);\n    await setDoc(doc_ref, data, { merge: true });\n    return true;\n  } catch (error) {\n    console.error(`Failed to create document by id: ${doc_id} in collection: ${collection_path}`, { error, data });\n    return false;\n  }\n};\nvar add_document = async (collection_path, data, include_id = false) => {\n  try {\n    const col_ref = collection(db, collection_path);\n    const doc_ref = await addDoc(col_ref, data);\n    if (include_id) {\n      await setDoc(doc_ref, { ...data, id: doc_ref.id }, { merge: true });\n    }\n    return true;\n  } catch (error) {\n    console.error(`Failed to create document in collection: ${collection_path}`, error);\n    return false;\n  }\n};\nvar delete_document = async (collection_path, doc_id) => {\n  try {\n    const doc_ref = doc(db, collection_path, doc_id);\n    await deleteDoc(doc_ref);\n    return true;\n  } catch (error) {\n    console.error(`Failed to delete document with id ${doc_id} from collection ${collection_path}`, error);\n    return false;\n  }\n};\nvar query_document = async (collection_path, field_name, operator, value, ignore_log = false) => {\n  try {\n    const q = query(collection(db, collection_path), where(field_name, operator, value));\n    const query_snapshot = await getDocs(q);\n    const documents = query_snapshot.docs.map((doc2) => simpleExtractData(doc2));\n    if (documents.length < 1) {\n      throw new Error(\n        `No data to return from: \ncollection: ${collection_path}, \nfield_name: ${field_name}, \noperator: ${operator}, \nvalue: ${value}`\n      );\n    }\n    return documents[0];\n  } catch (error) {\n    if (!ignore_log) {\n      console.error(\"Error querying document:\", error);\n    }\n    return null;\n  }\n};\nvar query_documents = async (collection_path, field_name, operator, value) => {\n  try {\n    const q = query(collection(db, collection_path), where(field_name, operator, value));\n    const query_snapshot = await getDocs(q);\n    const documents = query_snapshot.docs.map((doc2) => simpleExtractData(doc2));\n    return documents;\n  } catch (error) {\n    console.error(`Error querying documents: ${collection_path} - ${field_name} - ${operator} - ${value} `, error);\n    return [];\n  }\n};\nvar query_documents_by_conditions = async (collection_path, where_conditions) => {\n  try {\n    let db_query = collection(db, collection_path);\n    where_conditions.forEach((condition) => {\n      db_query = query(db_query, where(condition.field_name, condition.operator, condition.value));\n    });\n    const query_snapshot = await getDocs(db_query);\n    const documents = query_snapshot.docs.map((doc2) => simpleExtractData(doc2));\n    return documents;\n  } catch (error) {\n    console.error(`Error querying documents: ${collection_path} - ${JSON.stringify(where_conditions)} `, error);\n    return [];\n  }\n};\nvar query_document_by_conditions = async (collection_path, where_conditions) => {\n  try {\n    let db_query = collection(db, collection_path);\n    where_conditions.forEach((condition) => {\n      db_query = query(db_query, where(condition.field_name, condition.operator, condition.value));\n    });\n    const query_snapshot = await getDocs(db_query);\n    const documents = query_snapshot.docs.map((doc2) => simpleExtractData(doc2));\n    if (!documents[0]) {\n      throw new Error(\"No data returned from DB\");\n    }\n    return documents[0];\n  } catch (error) {\n    console.error(`Error querying documents: ${collection_path} - ${JSON.stringify(where_conditions)} `, error);\n    return null;\n  }\n};\nvar snapshot = (config, snapshotsFirstTime) => {\n  let resolvePromise;\n  let isResolved = false;\n  const promise = new Promise((resolve) => {\n    console.log(`==> ${config.collectionName} subscribed.`);\n    resolvePromise = () => {\n      if (!isResolved) {\n        isResolved = true;\n        resolve();\n      }\n    };\n  });\n  let collectionRef = collection(db, config.collectionName);\n  if (config.conditions) {\n    config.conditions.forEach((condition) => {\n      collectionRef = query(collectionRef, where(condition.field_name, condition.operator, condition.value));\n    });\n  }\n  const unsubscribe = onSnapshot(\n    collectionRef,\n    (snapshot2) => {\n      if (!snapshotsFirstTime.includes(config.collectionName)) {\n        snapshotsFirstTime.push(config.collectionName);\n        const documents = snapshot2.docs.map((doc2) => simpleExtractData(doc2));\n        config.onFirstTime?.(documents, config);\n        config.extraParsers?.forEach((extraParser) => {\n          extraParser.onFirstTime?.(documents, config);\n        });\n        resolvePromise();\n      } else {\n        const addedDocs = [];\n        const modifiedDocs = [];\n        const removedDocs = [];\n        snapshot2.docChanges().forEach((change) => {\n          if (change.type === \"added\") {\n            addedDocs.push(simpleExtractData(change.doc));\n          } else if (change.type === \"modified\") {\n            modifiedDocs.push(simpleExtractData(change.doc));\n          } else if (change.type === \"removed\") {\n            removedDocs.push(simpleExtractData(change.doc));\n          }\n        });\n        addedDocs.length && config.onAdd?.(addedDocs, config);\n        modifiedDocs.length && config.onModify?.(modifiedDocs, config);\n        removedDocs.length && config.onRemove?.(removedDocs, config);\n        config.extraParsers?.forEach((extraParser) => {\n          addedDocs.length && extraParser.onAdd?.(addedDocs, config);\n          modifiedDocs.length && extraParser.onModify?.(modifiedDocs, config);\n          removedDocs.length && extraParser.onRemove?.(removedDocs, config);\n        });\n      }\n    },\n    (error) => {\n      console.error(`Error listening to collection: ${config.collectionName}`, error);\n      resolvePromise();\n    }\n  );\n  return { promise, unsubscribe };\n};\nvar snapshotDocument = (config, snapshotsFirstTime) => {\n  let resolvePromise;\n  let isResolved = false;\n  const promise = new Promise((resolve) => {\n    console.log(`==> Document in ${config.collectionName} subscribed.`);\n    resolvePromise = () => {\n      if (!isResolved) {\n        isResolved = true;\n        resolve();\n      }\n    };\n  });\n  const documentRef = doc(db, config.collectionName, config.documentId);\n  const unsubscribe = onSnapshot(\n    documentRef,\n    (docSnapshot) => {\n      if (!snapshotsFirstTime.includes(config.collectionName)) {\n        snapshotsFirstTime.push(config.collectionName);\n        if (docSnapshot.exists()) {\n          const document2 = simpleExtractData(docSnapshot);\n          if (checkConditions(document2, config.conditions)) {\n            config.onFirstTime?.([document2], config);\n            config.extraParsers?.forEach((extraParser) => {\n              extraParser.onFirstTime?.([document2], config);\n            });\n          } else {\n            console.warn(`Document in ${config.collectionName} does not meet conditions.`);\n          }\n        } else {\n          console.warn(`Document not found in ${config.collectionName}.`);\n        }\n        resolvePromise();\n      } else {\n        if (docSnapshot.exists()) {\n          const document2 = simpleExtractData(docSnapshot);\n          if (checkConditions(document2, config.conditions)) {\n            config.onModify?.([document2], config);\n            config.extraParsers?.forEach((extraParser) => {\n              extraParser.onModify?.([document2], config);\n            });\n          }\n        } else {\n          config.onRemove?.([], config);\n          config.extraParsers?.forEach((extraParser) => {\n            extraParser.onRemove?.([], config);\n          });\n        }\n      }\n    },\n    (error) => {\n      console.error(`Error listening to document in ${config.collectionName}:`, error);\n      resolvePromise();\n    }\n  );\n  return { promise, unsubscribe };\n};\nvar checkConditions = (document2, conditions) => {\n  if (!conditions || conditions.length === 0) return true;\n  return conditions.every((condition) => {\n    const fieldValue = document2[condition.field_name];\n    switch (condition.operator) {\n      case \"==\":\n        return fieldValue === condition.value;\n      case \"!=\":\n        return fieldValue !== condition.value;\n      case \"<\":\n        return fieldValue < condition.value;\n      case \"<=\":\n        return fieldValue <= condition.value;\n      case \">\":\n        return fieldValue > condition.value;\n      case \">=\":\n        return fieldValue >= condition.value;\n      case \"array-contains\":\n        return Array.isArray(fieldValue) && fieldValue.includes(condition.value);\n      default:\n        return false;\n    }\n  });\n};\nvar cleanNxSites = async () => {\n  const clients = (await get_all_documents(\"nx-clients\")).map((v) => v.id);\n  const sites = await get_all_documents(\"nx-sites\");\n  const allSitesToDelete = sites.filter((v) => !clients.includes(v.client));\n  console.log(\"allSitesToDelete\", allSitesToDelete);\n  allSitesToDelete.forEach(async (v) => {\n    await delete_document(\"nx-sites\", v.id);\n    console.log(`Site ${v.id} deleted.`);\n  });\n};\n\n// src/helpers/global.ts\nimport { CountryOptions } from \"akeyless-types-commons\";\nimport axios from \"axios\";\n\n// src/helpers/phoneNumber.ts\nimport { parsePhoneNumberFromString } from \"libphonenumber-js\";\nvar isInternational = (phone_number) => {\n  return phone_number.startsWith(\"+\");\n};\nvar isInternationalIsraelPhone = (phone_number) => {\n  return phone_number.startsWith(\"+9725\");\n};\nvar local_israel_phone_format = (international_number) => {\n  return international_number.replace(\"+972\", \"0\");\n};\nvar international_israel_phone_format = (phone) => {\n  const validNumber = phone.slice(1, phone.length);\n  return \"+972\".concat(validNumber);\n};\nvar displayFormatPhoneNumber = (phoneNumber) => {\n  if (isInternational(phoneNumber)) {\n    const phoneNumberObject = parsePhoneNumberFromString(phoneNumber);\n    if (!phoneNumberObject) {\n      return phoneNumber;\n    }\n    return phoneNumberObject.formatInternational().replace(/\\s/g, \"\");\n  }\n  return phoneNumber.replace(/(\\d{3})(\\d{3})(\\d{4})/, \"$1-$2-$3\");\n};\nvar is_iccid = (number) => {\n  if (number.length < 19 || number.length > 22) return false;\n  if (!/^\\d+$/.test(number)) return false;\n  if (!number.startsWith(\"89\")) return false;\n  return true;\n};\n\n// src/helpers/global.ts\nvar calculateBearing = (startLat, startLng, endLat, endLng) => {\n  if (startLat === endLat || startLng === endLng) {\n    return 0;\n  }\n  if (startLat === void 0 || startLng === void 0 || endLat === void 0 || endLng === void 0) {\n    return 0;\n  }\n  const startLatRad = startLat * Math.PI / 180;\n  const startLngRad = startLng * Math.PI / 180;\n  const endLatRad = endLat * Math.PI / 180;\n  const endLngRad = endLng * Math.PI / 180;\n  const dLon = endLngRad - startLngRad;\n  const y = Math.sin(dLon) * Math.cos(endLatRad);\n  const x = Math.cos(startLatRad) * Math.sin(endLatRad) - Math.sin(startLatRad) * Math.cos(endLatRad) * Math.cos(dLon);\n  const bearing = Math.atan2(y, x) * 180 / Math.PI;\n  return (bearing + 360) % 360;\n};\nvar renderOnce = () => {\n  return true;\n};\nvar getUserCountryByIp = async () => {\n  try {\n    const response = await axios.get(\"https://ipapi.co/json/\");\n    return (response.data.country_code || CountryOptions.IL).toLowerCase();\n  } catch (error) {\n    console.error(\"Error fetching Country:\", error);\n    return CountryOptions.IL;\n  }\n};\nvar parsePermissions = (object) => {\n  if (!object?.features) {\n    return {};\n  }\n  const features = object.features;\n  let result = {};\n  features.forEach((feature) => {\n    if (!feature.includes(\"__\")) {\n      return;\n    }\n    const [featureType, featureName] = feature.split(\"__\");\n    if (!featureType || !featureName) {\n      return;\n    }\n    if (!result[featureType]) {\n      result[featureType] = {};\n    }\n    result[featureType][featureName] = true;\n  });\n  return result;\n};\nvar initializeUserPermissions = async ({ phoneNumber, firstTimeArray, getUpdatePermissions }) => {\n  let unsubscribe = null;\n  let permissions = {};\n  try {\n    const { promise, unsubscribe: unsubscribeSnapshot } = snapshot(\n      {\n        collectionName: \"nx-users\",\n        conditions: [{ field_name: \"phone_number\", operator: \"in\", value: [phoneNumber, local_israel_phone_format(phoneNumber)] }],\n        onFirstTime: (docs) => {\n          if (!docs.length) {\n            throw new Error(\"User not found\");\n          }\n          permissions = parsePermissions(docs[0]);\n          getUpdatePermissions(parsePermissions(docs[0]));\n        },\n        onModify: (docs) => {\n          getUpdatePermissions(parsePermissions(docs[0]));\n        }\n      },\n      firstTimeArray\n    );\n    unsubscribe = unsubscribeSnapshot;\n    await promise;\n    return { unsubscribe, permissions };\n  } catch (error) {\n    if (unsubscribe) {\n      unsubscribe();\n    }\n    console.error(\"Error initializing user permissions:\", error.message);\n    throw error;\n  }\n};\nvar userNameFormat = (user) => {\n  return `${user?.first_name || \"\"} ${user?.last_name || \"\"}`.trim();\n};\nvar multiStringFormat = (str1, str2, str3) => {\n  return `${str1} ${str2 || \"\"} ${str3 || \"\"}`.trim();\n};\nvar getLocationUrl = (lang, lat) => {\n  return `https://www.google.com/maps?q=${lang},${lat}`;\n};\n\n// src/helpers/forms.ts\nimport XRegExp from \"xregexp\";\nvar textRegex = XRegExp(\"[^\\\\p{L}\\\\s-]\", \"gu\");\nvar numbersRegex = XRegExp(\"[^0-9\\\\s-+]\", \"g\");\nvar numbersOnlyRegex = XRegExp(\"[^0-9]\", \"g\");\nvar priceRegex = XRegExp(\"[^0-9.]\", \"g\");\nvar emailRegex = XRegExp(\"[^\\\\p{L}0-9.@\\\\s-]\", \"gu\");\nvar colorRegex = XRegExp(\"[^#0-9A-Fa-f]\", \"g\");\nvar carsRegex = XRegExp(\"[^\\\\p{L}0-9,_]\", \"gu\");\nvar textNumbersRegex = XRegExp(\"[^\\\\p{L}0-9\\\\s+\\\\-]\", \"gu\");\nvar addressRegex = XRegExp(\"[^\\\\p{L}0-9\\\\s.,\\\\-]\", \"gu\");\nvar chartsRegex = XRegExp(\"[^\\\\p{L}0-9\\\\s.,_@!\\\\-]\", \"gu\");\nvar handleChange = (e) => {\n  e.target.setCustomValidity(\"\");\n  const validation = e.target.getAttribute(\"data-validation\");\n  if (validation === \"text\") {\n    e.target.value = XRegExp.replace(e.target.value, textRegex, \"\");\n  } else if (validation === \"numbers\") {\n    e.target.value = XRegExp.replace(e.target.value, numbersRegex, \"\");\n  } else if (validation === \"numbersOnly\") {\n    e.target.value = XRegExp.replace(e.target.value, numbersOnlyRegex, \"\");\n  } else if (validation === \"price\") {\n    e.target.value = XRegExp.replace(e.target.value, priceRegex, \"\");\n  } else if (validation === \"textNumbers\") {\n    e.target.value = XRegExp.replace(e.target.value, textNumbersRegex, \"\");\n  } else if (validation === \"email\") {\n    e.target.value = XRegExp.replace(e.target.value, emailRegex, \"\");\n  } else if (validation === \"color\") {\n    e.target.value = XRegExp.replace(e.target.value, colorRegex, \"\");\n  } else if (validation === \"address\") {\n    e.target.value = XRegExp.replace(e.target.value, addressRegex, \"\");\n  } else if (validation === \"cars\") {\n    e.target.value = XRegExp.replace(e.target.value, carsRegex, \"\");\n  } else if (validation === \"charts\") {\n    e.target.value = XRegExp.replace(e.target.value, chartsRegex, \"\");\n  }\n};\nvar handlePaste = (e) => {\n  const validation = e.currentTarget.getAttribute(\"data-validation\");\n  let pasteData = e.clipboardData.getData(\"text\");\n  if (validation === \"text\") {\n    pasteData = XRegExp.replace(pasteData, textRegex, \"\");\n  } else if (validation === \"numbers\") {\n    pasteData = XRegExp.replace(pasteData, numbersRegex, \"\");\n  } else if (validation === \"numbersOnly\") {\n    pasteData = XRegExp.replace(pasteData, numbersOnlyRegex, \"\");\n  } else if (validation === \"price\") {\n    pasteData = XRegExp.replace(pasteData, priceRegex, \"\");\n  } else if (validation === \"textNumbers\") {\n    pasteData = XRegExp.replace(pasteData, textNumbersRegex, \"\");\n  } else if (validation === \"email\") {\n    pasteData = XRegExp.replace(pasteData, emailRegex, \"\");\n  } else if (validation === \"color\") {\n    pasteData = XRegExp.replace(pasteData, colorRegex, \"\");\n  } else if (validation === \"address\") {\n    pasteData = XRegExp.replace(pasteData, addressRegex, \"\");\n  } else if (validation === \"cars\") {\n    pasteData = XRegExp.replace(pasteData, carsRegex, \"\");\n  } else if (validation === \"charts\") {\n    pasteData = XRegExp.replace(pasteData, chartsRegex, \"\");\n  }\n  e.preventDefault();\n  document.execCommand(\"insertText\", false, pasteData);\n};\nvar handleInvalid = (e, requireError) => {\n  e.target.setCustomValidity(requireError || \"This filed is required !\");\n};\nvar useValidation = (validationType, requireError) => {\n  return {\n    onChange: handleChange,\n    onPaste: handlePaste,\n    onInvalid: (e) => handleInvalid(e, requireError),\n    \"data-validation\": validationType\n  };\n};\nvar getFormElementValue = (form, name) => {\n  return form.elements.namedItem(name)?.value || \"\";\n};\nvar parseMultiSelectInput = (input) => {\n  const value = JSON.parse(input) || [];\n  return value.map((v) => v.value);\n};\n\n// src/helpers/store.ts\nvar setState = (updater, set, stateName) => {\n  return set((state) => ({\n    [stateName]: typeof updater === \"function\" ? updater(state[stateName]) : updater\n  }));\n};\nvar createSelectors = (store) => {\n  let selectors = {};\n  for (let k of Object.keys(store.getState())) {\n    selectors[k] = () => store((s) => s[k]);\n  }\n  return selectors;\n};\nvar useStoreValues = (store, keys) => {\n  const result = {};\n  keys.forEach((key) => {\n    result[key] = store.use[key]();\n  });\n  return result;\n};\n\n// src/lib/utils.ts\nimport { clsx } from \"clsx\";\nimport { twMerge } from \"tailwind-merge\";\nfunction cn(...inputs) {\n  return twMerge(clsx(inputs));\n}\n\n// src/helpers/time_helpers.ts\nimport { Timestamp as Timestamp2 } from \"firebase/firestore\";\nimport moment2 from \"moment-timezone\";\nfunction timestamp_to_string(firebaseTimestamp, options) {\n  let date;\n  if (firebaseTimestamp instanceof Timestamp2) {\n    date = firebaseTimestamp.toDate();\n  } else if (firebaseTimestamp instanceof Date) {\n    date = firebaseTimestamp;\n  } else if (typeof firebaseTimestamp === \"string\") {\n    date = moment2.utc(firebaseTimestamp, options?.fromFormat || \"DD/MM/YYYY HH:mm:ss\").toDate();\n    if (isNaN(date.getTime())) {\n      throw new Error(\"Invalid date string format\");\n    }\n  } else {\n    throw new Error(\"Invalid input: firebaseTimestamp must be a Timestamp, Date, or valid date string.\");\n  }\n  if (options?.tz) {\n    const result = moment2(date).tz(options?.tz).format(options?.format || \"DD/MM/YYYY HH:mm:ss\");\n    return result;\n  }\n  return moment2.utc(date).format(options?.format || \"DD/MM/YYYY HH:mm:ss\");\n}\nfunction timestamp_to_millis(firebaseTimestamp) {\n  const timestamp = new Timestamp2(firebaseTimestamp?.seconds, firebaseTimestamp?.nanoseconds);\n  return timestamp.toMillis();\n}\nfunction sort_by_timestamp(a, b, reverse = false) {\n  return reverse ? timestamp_to_millis(b) - timestamp_to_millis(a) : timestamp_to_millis(a) - timestamp_to_millis(b);\n}\nexport {\n  add_document,\n  addressRegex,\n  auth,\n  calculateBearing,\n  carsRegex,\n  chartsRegex,\n  cleanNxSites,\n  cn,\n  collections,\n  colorRegex,\n  createSelectors,\n  db,\n  delete_document,\n  displayFormatPhoneNumber,\n  emailRegex,\n  extractAlertsData,\n  extractBoardsData,\n  extractCanbusData,\n  extractCarsData,\n  extractClientData,\n  extractLocationData,\n  extractSiteData,\n  fire_base_TIME_TEMP,\n  formatCarNumber,\n  getFormElementValue,\n  getLocationUrl,\n  getUserCountryByIp,\n  get_all_documents,\n  get_document_by_id,\n  handleChange,\n  handleInvalid,\n  handlePaste,\n  initializeUserPermissions,\n  international_israel_phone_format,\n  isInternational,\n  isInternationalIsraelPhone,\n  is_iccid,\n  local_israel_phone_format,\n  multiStringFormat,\n  numbersOnlyRegex,\n  numbersRegex,\n  parseMultiSelectInput,\n  parsePermissions,\n  priceRegex,\n  query_document,\n  query_document_by_conditions,\n  query_documents,\n  query_documents_by_conditions,\n  renderOnce,\n  setState,\n  set_document,\n  simpleExtractData,\n  snapshot,\n  snapshotDocument,\n  sort_by_timestamp,\n  storage,\n  textNumbersRegex,\n  textRegex,\n  timestamp_to_millis,\n  timestamp_to_string,\n  useStoreValues,\n  useValidation,\n  userNameFormat\n};\n"]}